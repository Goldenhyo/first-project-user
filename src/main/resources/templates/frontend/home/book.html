<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<th:block th:replace="~{frontend/layouts/baseAd :: baseAd(~{this::content})}">
    <th:block th:fragment="content">
        <section class="section_wrap sec_ad_01">
            <div class="section_wrap_pagebody flex_between">
                <div class="bo_sec_01_img">
                    <img th:src="|/images/${book.bookImgStored}|" alt="" />
                </div>
                <div class="bo_sec_01_text">
                    <div class="book_title_wrap">
                        <p class="book_title" th:text="${book.bookTitle}">세이노의 가르침</p>
                        <a href="" class="book_ca_btn" th:text="${book.bookCategory.bookCategoryName}">인문</a>
                    </div>
                    <div class="book_iftext_wrap">
                        <span th:text="${book.bookWriter}">세이노 <span>지음</span></span>
                        <span> / </span>
                        <span th:text="${book.bookPub}">샘터사</span>
                    </div>
                    <div class="book_iftext_wrap line_bt_gr">
                        <span>ISBN : </span>
                        <span th:text="${book.isbn}">111122223333</span>
                    </div>
                    <div class="book_store_wrap line_bt_gr">
                        <div class="store_img">
                            <img th:if="${book.getStore().getStoreImageStored() != null}" th:src="|/images/${book.getStore().getStoreImageStored()}|"/>
                        </div>
                        <div class="book_storetext_wrap">
                            <p th:text="${book.store.storeTitle}">[판매서점]환상문학</p>
                            <span th:text="${book.store.storeAddress}">서울시 마포구 성지1길 30 지하1층</span>
                        </div>
                        <div class="book_storetext_btnwrap">
                            <button class="greyLine_btn" th:onclick="|location.href='/store/' + ${book.getStore().getStoreId()}|">서점보러가기</button>
                        </div>
                    </div>
                    <div class="book_storetext02_wrap line_bt_gr">
                        <div>
                            <p>이용안내</p>
                        </div>
                        <div>
                            <p>
                                • 배송 없이 구매 후 바로 읽기 <br />
                                • 이용기간 제한없음 <br />
                                • 저작권 보호를 위한 인쇄 기능 제공 안함
                            </p>
                        </div>
                    </div>
                    <div class="book_storetext03_wrap line_bt_gr">
                        <div class="book_storetext03">
                            <span>일반도서 판매가</span>
                            <div>
                                <span th:text="${book.bookPaperPrice}">15,000</span>
                                <span>원</span>
                            </div>
                        </div>
                        <div>
                            <span>전자도서 판매가</span>
                            <div>
                                <span class="book_pay_text" th:text="${book.bookEbookPrice}"> 12,000 </span>
                                <span>원</span>
                            </div>
                        </div>
                    </div>
                    <div class="book_button_wrap" sec:authorize="isAuthenticated()">
                        <button class="blackLine_btn" id="cartLoginButton"  th:data-bookId="${book.bookId}">
                            장바구니에 담기</button>
                        <button class="point_btn" th:onclick="|location.href='@{/cart/list}'|">구매하기</button>
                    </div>
                    <div class="book_button_wrap notLogin" sec:authorize="isAnonymous()">
                        <button class="blackLine_btn">
                            장바구니에 담기</button>
                        <button class="point_btn">구매하기</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="section_wrap">
            <div class="section_wrap_pagebody flex_between page_line">
                <div class="sec_h_wrap">
                    <h2>도서정보</h2>
                    <hr />
                    <div class="sec_text_wrap wrap_bottom_line">
                        <h3>목차</h3>
                        <p th:text="${book.getBookIndex()}">내용</p>
                    </div>
                    <div class="sec_text_wrap wrap_bottom_line">
                        <h3>소개</h3>
                        <p th:text="${book.getBookIntro()}">내용</p>
                    </div>
                    <div class="sec_text_wrap wrap_bottom_line">
                        <h3>저자소개</h3>
                        <p th:text="${book.getBookWriterProfile()}">내용</p>
                    </div>
                    <div class="sec_text_wrap">
                        <h3><span th:text="${book.getStore().getStoreTitle()}">환상문학</span>의 리뷰</h3>
                        <p th:text="${book.getBookReview()}">내용</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="section_wrap">
            <div class="section_wrap_pagebody flex_between page_line">
                <div class="sec03_img_wrap">
                    <img th:if="${book.getStore().getStoreImageStored02() != null}" th:src="|/images/${book.getStore().getStoreImageStored02()}|"/>
                </div>
                <div class="sec03_text_wrap">
                    <p><span class="point_text" th:text="${book.getStore().getStoreTitle()}">"환상문학"</span>이 생각하는 독립서점이란 단순히 출판물을 판매하는 것이 아닌 사람들 간의 삶과 생각을 남기는 가치 있는 문화라고 생각합니다.</p>
                    <button class="point_btn" id="toStore" type="button" th:onclick="|location.href='/store/' + ${book.getStore().getStoreId()}|"><span th:text="${book.getStore().getStoreTitle()}">환상문학</span> 방문하기</button>
                </div>
            </div>
        </section>

        <section class="section_wrap">
            <div class="section_wrap_pagebody page_line">
                <div class="sec_h_wrap">
                    <h2><span th:text="${book.getStore().getStoreTitle()}">환상문학</span>의 다른 도서들</h2>
                </div>
                <div class="item_list_wrap">
                    <ul class="flex_start">
                        <li>
                            <div class="item_img_wrap" style="background-image: url('https://image.yes24.com/goods/117014614/XL')"></div>
                            <p>위험을 향해 달리다</p>
                            <span>
                                <span>이제하</span>
                                지음 /
                                <span>샘터사</span>
                            </span>
                        </li>
                        <li>
                            <div class="item_img_wrap" style="background-image: url('https://image.yes24.com/goods/117014616/XL')"></div>
                            <p>위험을 향해 달리다</p>
                            <span>
                                <span>이제하</span>
                                지음 /
                                <span>샘터사</span>
                            </span>
                        </li>
                        <li>
                            <div class="item_img_wrap" style="background-image: url('https://image.yes24.com/goods/117014615/XL')"></div>
                            <p>위험을 향해 달리다</p>
                            <span>
                                <span>이제하</span>
                                지음 /
                                <span>샘터사</span>
                            </span>
                        </li>
                        <li>
                            <div class="item_img_wrap" style="background-image: url('https://image.yes24.com/goods/117014613/XL')"></div>
                            <p>위험을 향해 달리다</p>
                            <span>
                                <span>이제하</span>
                                지음 /
                                <span>샘터사</span>
                            </span>
                        </li>
                        <li>
                            <div class="item_img_wrap" style="background-image: url('https://image.yes24.com/goods/117014611/XL')"></div>
                            <p>위험을 향해 달리다</p>
                            <span>
                                <span>이제하</span>
                                지음 /
                                <span>샘터사</span>
                            </span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>
        <section class="section_wrap">
            <div class="section_wrap_pagebody">
                <!-- 리뷰헤더 -->
                <div class="sec_h_wrap flex_between">
                    <h2>한줄리뷰</h2>
                    <select name="" id="">
                        <option value="">최신순</option>
                        <option value="">이전순</option>
                    </select>
                </div>

                <!-- 리뷰 -->
                <div class="review_wrap flex_between">
                    <div class="review_text_wrap">
                        <h4>아이디</h4>
                        <p>내요오오오옹내요오오오옹내요오오오옹 내요오오오옹내요오오오옹내요오오오옹 내요오오오옹내요오오오옹내요오오오옹</p>
                        <span>2024-4-10</span>
                    </div>
                    <div class="review_btn_wrap">
                        <button class="greyLine_btn">댓글쓰기</button>
                    </div>
                </div>

                <!-- 리뷰 -->
                <div class="review_wrap flex_between">
                    <div class="review_text_wrap">
                        <h4>아이디</h4>
                        <p>내요오오오옹내요오오오옹내요오오오옹 내요오오오옹내요오오오옹내요오오오옹 내요오오오옹내요오오오옹내요오오오옹</p>
                        <span>2024-4-10</span>
                    </div>
                    <div class="review_btn_wrap">
                        <button class="greyLine_btn">댓글쓰기</button>
                    </div>
                </div>

                <!-- 리뷰 나눔선 -->
                <div class="review_wrap flex_between">
                    <div class="review_text_wrap"></div>
                </div>

                <!-- 페이징 -->
                <div class="paging_wrap">
                    <div class="paging_bar">
                        <ul class="flex_between">
                            <li>Prev</li>
                            <li>1</li>
                            <li>2</li>
                            <li>3</li>
                            <li>4</li>
                            <li>5</li>
                            <li>Next</li>
                        </ul>
                    </div>
                </div>
                <!-- 리뷰작성 -->
                <div class="sec_h_wrap">
                    <h2>리뷰작성</h2>
                    <div class="review_input_form">
                        <form action="post">
                            <input class="review_input" type="text" />
                            <button type="submit" class="review_input_btn point_btn">댓글작성</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </th:block>
</th:block>
<script th:inline="javascript">
$(document).ready(function (){
    $(".notLogin").on("click", function () {
        let confirmation = confirm("로그인이 필요한 서비스입니다. 로그인 하시겠습니까?");
        if (confirmation) {
            window.location.href = '/login';
        }
    });

    $("#cartLoginButton").on("click", function () {
        console.log("장바구니 버튼 클릭");
        let bookId = $(this).attr("data-bookId");
        console.log("bookId: ", bookId);
        $.ajax({
            url: '/cart/' + bookId + '/addBook',
            type: 'GET',
            success: function(response) {
                if (response === 'success') {
                    alert('장바구니에 도서가 추가되었습니다.');
                } else if(response === 'fail') {
                    alert('이미 장바구니에 담겨있는 도서입니다.');
                }
            },
            error: function(xhr, status, error) {
                console.error('Error:', error);
            }
        });
    });


});
</script>
</html>